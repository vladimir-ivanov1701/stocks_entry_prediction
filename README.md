# Проект модели для потенциального входа в сделку на биржевых торгах.
## 1. Идея
Модель на анализе временных рядов, но с одним нюансом. Нужно предсказать не будущую цену актива, а вероятность удачной сделки с заданным Take Profit и Stop Loss. В итоге должно получиться две модели бинарной классификации: одна для покупки, вторая для продажи.
**Оптимизация.** В этой задаче для получения прибыли доля правильных ответов модели должна быть больше 50%. Таким образом, имеет смысл оптимизировать * *Precision* * таким образом, чтобы общее количество сделок было не менее определённого порога (например, 100 за год).

## 2. ToDo List
[x] Создать репозиторий
[x] Собрать сырые данные
[x] Заполнить README.md
[x] Расчёт факторов
[x] Тесты для расчёта факторов
[ ] Биннинг
[ ] Однофакторный анализ
[ ] Многофакторный анализ
[ ] Расчёт финансового эффекта
[ ] Оптимизация метрики

## 3. Терминология

- **Свеча** - Часть графика движения цены финансового инструмента за определённый интервал времени (таймфрейм), зафиксированная на 4 уровнях: Open, High, Low и Close.
- **Open** - Цена открытия. Значение цены в момент начала временного интервала.
- **High** - Максимальное значение цены, достигнутое в любой момент данного интервала времени.
- **Low** - Минимальное значение цены, достигнутое в любой момент данного интервала времени.
- **Close** - Цена в момент окончания интервала времени.
- **Направление свечи** - Если Close > Open - восходящее, обозначается зелёным цветом. Если Close < Open - нисходящее, обозначается красным цветом.
- **Размах свечи** - Длина всей свечи от High до Low.
- **Тело свечи** - Участок свечи между Open и Close.
- **Тени свечи** - Тонкие вертикальные линии выше и ниже тела свечи. Сверху – верхняя тень, снизу – нижняя тень | Теней может и не быть. Это значит, что 2 уровня равны (напр. Close = High, Open = Low).
- **Начальная коррекция** - Тень возле уровня Open. Отдельно, как правило, не анализируется, т.к. косвенно влияет на длину тела.
- **Конечная коррекция** - Тень возле уровня Close. Конечная коррекция важнее, т.к. она ближе к текущему моменту после окончания свечи. Конечную коррекцию сравнивают не только в абсолютных величинах, но и в % от размаха. Процент считается, если визуально коррекции примерно одинаковые. Используют один из показателей (абсолютное значение или %), у которого больше разница.
- **Pivot (уровень равновесия) свечи** - Pivot = (High + Low + Close) / 3. Равновесный, более информативный уровень. Более полно характеризует свечу.
- **Активность свечи** - Чем длиннее свеча и меньше конечная коррекция, тем активнее свеча. Активность - не абсолютная величина. Рассчитывается изменение активности относительно предыдущей свечи. Свечи сравниваются по 4 параметрам:
    - Размах
    - Тело
    - Конечная коррекция
    - Взаимоположение свечей. При восходящем тренде High[i] > High[i-1] и Low[i] > Low[i-1]. При нисходящем тренде High[i] < High[i-1] и Low[i] < Low[i-1]. Если свечи разного направления, то сравнивают только размахи и взаимоположение.
- **Свеча с нулевым телом** - Свеча, у которой уровни Open и Close совпадают. Для расчёта активности такую свечу удобно считать сонаправленной с предыдущей свечой.
- **Фрактал** - Структура минимум из 3 свечей, в которой средняя свеча является либо максимумом (фрактал Up), либо минимумом (фрактал Down).

## 4. Подготовка и запуск
### 4.1. Клонирование репозитория
```
git clone https://github.com/vladimir-ivanov1701/stocks_entry_prediction.git
cd stocks_entry_prediction
```
### 4.2. Установка виртуального окружения и зависимостей
```
python -m venv venv
source venv/Scripts/activate
pip install -r requirements.txt
```

## 5. Исходные данные
Исходные данные хранятся в файле * *src/stock_data.xlsx* *. Данные сохраняются в этот файл вручную с https://www.finam.ru/quote/moex/gazp/export/.
